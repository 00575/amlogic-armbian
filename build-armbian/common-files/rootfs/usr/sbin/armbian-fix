#!/bin/bash
#============================================================================================================================
# This file is licensed under the terms of the GNU General Public
# License version 2. This program is licensed "as is" without any
# warranty of any kind, whether express or implied.
#
# This file is a part of the Armbian Rebuild and kernel Recompile script
# https://github.com/ophub/amlogic-s9xxx-armbian
#
# Dependent script: /usr/lib/armbian/armbian-firstrun
# Function: Fix permissions and related settings(Executed at system initialization)
# Copyright (C) 2021 https://github.com/ophub/amlogic-s9xxx-armbian
#
# Command: armbian-fix
#============================================================================================================================

# Fix permissions
sudo apt-get -qq purge -y linux-image-current-meson64
sudo chmod 777 /var/tmp 2>/dev/null
sudo chown man:root /var/cache/man -R 2>/dev/null
sudo chmod g+s /var/cache/man -R 2>/dev/null
sudo chown root:root /usr/bin/sudo 2>/dev/null
sudo chmod 4755 /usr/bin/sudo 2>/dev/null
sudo chown 0 /usr/lib/sudo/sudoers.so 2>/dev/null
sudo chmod 644 /usr/lib/sudo/sudoers.so 2>/dev/null
sudo chmod 4755 /usr/lib/policykit-1/polkit-agent-helper-1 2>/dev/null
sudo chmod 755 /etc/update-motd.d/* 2>/dev/null

echo -e "armbian-fix: Loading finished."

